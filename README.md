<p align="center">
  <img src="https://github.com/user-attachments/assets/6e1ee6c5-bba1-48f6-bc4c-62407fb0cd12" width="462" height="268" alt="TOFFEE_Logo" />
  <figcaption>
    <i class="photo-credit">Logo Credit: Alexis Antonopoulos</i>
  </figcaption>
</p>

# TOFFEE
Software to de-trend and find flares in TESS data. Build to find epochs of increased emission and distinguish overlapping flare events to be complete down to short wait times.

## Installation

TOFFEE is able to be installed on pip under the name star-toffee (toffee was already taken):

```
pip install star_toffee
```

Import TOFFEE into python script using toffee

```
import toffee
```
## Getting Started

For more information on running TOFFEE consult the [flare_finder manual page](https://github.com/JasonReeves702/TOFFEE/blob/main/docs/flare_finder_manual.rst) and the [tutorials](https://github.com/JasonReeves702/TOFFEE/tree/main/tutorials)


## How to Cite this Work

If you end up using this work please be sure to cite the relevant papers describing it's creation: Pratt et al. 2025 (submitted) and Reeves et al. 2025 (submitted). As of December 2025 both of these papers have not been accepted. Be sure to check back for updates in where to find the papers when they're published.

## Issues?

TOFFEE is still under development on GitHub and on PyPI. If you notice a bug or error in the code feel free to email Jason at his email: jason.reeves@tufts.edu or submit an issue on [GitHub](https://github.com/JasonReeves702/TOFFEE/issues)

## Other Relevant Citations

TOFFEE is built upon the work of previous studies in flare detection and modeling. Depending on your specific goals you may want to consider the following papers:

[1] Mosteller, Frederick, and John Wilder Tukey. Data Analysis and Regression. Pearson, 1977.

[2] Ilin, E. et al. Flares in open clusters with K2. II. Pleiades, Hyades, Praesepe,Ruprecht 147, and M 67. 645, A42 (2021).

[3]  Davenport, J. R. A. et al. Kepler flares. ii. the temporal morphology of white-light flares on gj 1243. The Astrophysical Journal 797, 122 (2014). URL https://dx.doi.org/10.1088/0004-637X/797/2/122.

[4] Yang, H. & Liu, J. The Flare Catalog and the Flare Activity in the Kepler Mission. 241, 29 (2019).

[5] Howard, W. S. & MacGregor, M. A. No such thing as a simple flare: Substructure and quasi-periodic pulsations observed in a statistical sample of 20 s cadence tess flares. The Astrophysical Journal 926, 204 (2022). URL https://dx.doi.org/10.3847/1538-4357/ac426e.

[6] Chang, S. W., Byun, Y. I. & Hartman, J. D. Photometric Study on Stellar Magnetic Activity. I. Flare Variability of Red Dwarf Stars in the Open Cluster M37. 814, 35 (2015).

[7] Pitkin, M., Williams, D., Fletcher, L. & Grant, S. D. T. A bayesian method for detecting stellar flares. Monthly Notices of the Royal Astronomical Society 445, 2268â€“2284 (2014). URL https://doi.org/10.1093/mnras/stu1889.

[8] Rivera, E. C., Johnson, J. R., Homan, J. & Wing, S. How noise thresholds affect the information content of stellar flare sequences. 670, A143 (2023).
